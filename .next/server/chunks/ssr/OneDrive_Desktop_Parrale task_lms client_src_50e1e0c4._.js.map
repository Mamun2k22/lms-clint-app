{"version":3,"sources":["turbopack:///[project]/OneDrive/Desktop/Parrale task/lms client/src/lib/apis/http.ts","turbopack:///[project]/OneDrive/Desktop/Parrale task/lms client/src/app/admin/lectures/page.tsx"],"sourcesContent":["const BASE = process.env.NEXT_PUBLIC_API_BASE!;\r\n\r\n/** Client-side calls (adds Bearer from localStorage) */\r\nexport async function api<T = unknown>(path: string, init: RequestInit = {}): Promise<T> {\r\n  const token = typeof window !== \"undefined\" ? localStorage.getItem(\"token\") : null;\r\n  const headers = new Headers(init.headers);\r\n  if (!headers.has(\"Content-Type\")) headers.set(\"Content-Type\", \"application/json\");\r\n  if (token) headers.set(\"Authorization\", `Bearer ${token}`);\r\n  const res = await fetch(`${BASE}${path}`, { ...init, headers, cache: \"no-store\" });\r\n  if (!res.ok) throw await res.json().catch(() => ({ message: res.statusText }));\r\n  return (await res.json()) as T;\r\n}\r\n\r\n/** Server-side fetch (no token) for public endpoints */\r\nexport async function serverApi<T = unknown>(path: string, init: RequestInit = {}): Promise<T> {\r\n  const res = await fetch(`${BASE}${path}`, { ...init, cache: \"no-store\" });\r\n  if (!res.ok) throw await res.json().catch(() => ({ message: res.statusText }));\r\n  return (await res.json()) as T;\r\n}\r\n","\"use client\";\r\n\r\nimport { useEffect, useMemo, useState } from \"react\";\r\nimport { api } from \"@/lib/apis/http\";\r\nimport type { Course, Module, Lecture } from \"@/lib/types\";\r\n\r\nexport default function AdminLecturesPage() {\r\n  const [courses, setCourses] = useState<Course[]>([]);\r\n  const [modules, setModules] = useState<Module[]>([]);\r\n  const [lectures, setLectures] = useState<Lecture[]>([]);\r\n  const [courseId, setCourseId] = useState<string>(\"\");\r\n  const [moduleId, setModuleId] = useState<string>(\"\");\r\n  const [q, setQ] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      const cs = await api<Course[]>(\"/courses\");\r\n      setCourses(cs);\r\n    })();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      // modules depend on selected course\r\n      const ms = await api<Module[]>(`/modules${courseId ? `?course=${courseId}` : \"\"}`);\r\n      setModules(ms);\r\n      // reset module when course changes\r\n      setModuleId(\"\");\r\n    })();\r\n  }, [courseId]);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      const qs: string[] = [];\r\n      if (courseId) qs.push(`course=${courseId}`);\r\n      if (moduleId) qs.push(`module=${moduleId}`);\r\n      const url = `/lectures${qs.length ? `?${qs.join(\"&\")}` : \"\"}`;\r\n      const ls = await api<Lecture[]>(url);\r\n      setLectures(ls);\r\n    })();\r\n  }, [courseId, moduleId]);\r\n\r\n  const filtered = useMemo(() => {\r\n    const text = q.trim().toLowerCase();\r\n    return text ? lectures.filter(l => l.title.toLowerCase().includes(text)) : lectures;\r\n  }, [lectures, q]);\r\n\r\n  return (\r\n    <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-6\">\r\n      <header>\r\n        <h1 className=\"text-2xl sm:text-3xl font-bold\">Lecture List</h1>\r\n        <p className=\"text-gray-600\">Filter by course or module, search by title.</p>\r\n      </header>\r\n\r\n      {/* Filters */}\r\n      <div className=\"grid gap-3 sm:grid-cols-3\">\r\n        <select\r\n          value={courseId}\r\n          onChange={(e) => setCourseId(e.target.value)}\r\n          className=\"rounded-xl border px-3 py-2\"\r\n        >\r\n          <option value=\"\">All courses</option>\r\n          {courses.map(c => <option key={c._id} value={c._id}>{c.title}</option>)}\r\n        </select>\r\n\r\n        <select\r\n          value={moduleId}\r\n          onChange={(e) => setModuleId(e.target.value)}\r\n          className=\"rounded-xl border px-3 py-2\"\r\n        >\r\n          <option value=\"\">All modules</option>\r\n          {modules.map(m => (\r\n            <option key={m._id} value={m._id}>\r\n              {`Module ${m.moduleNo}: ${m.title}`}\r\n            </option>\r\n          ))}\r\n        </select>\r\n\r\n        <input\r\n          value={q}\r\n          onChange={(e) => setQ(e.target.value)}\r\n          placeholder=\"Search by lecture title…\"\r\n          className=\"rounded-xl border px-3 py-2\"\r\n        />\r\n      </div>\r\n\r\n      {/* Table */}\r\n      <div className=\"overflow-auto rounded-2xl border\">\r\n        <table className=\"min-w-full text-sm\">\r\n          <thead className=\"bg-gray-50 text-left\">\r\n            <tr>\r\n              <th className=\"px-4 py-3\">Order</th>\r\n              <th className=\"px-4 py-3\">Lecture Title</th>\r\n              <th className=\"px-4 py-3\">Module</th>\r\n              <th className=\"px-4 py-3\">Video URL</th>\r\n              <th className=\"px-4 py-3\">PDFs</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {filtered.map(l => {\r\n              const m = modules.find(x => x._id === l.moduleId);\r\n              return (\r\n                <tr key={l._id} className=\"border-t\">\r\n                  <td className=\"px-4 py-3 font-medium\">#{l.order}</td>\r\n                  <td className=\"px-4 py-3\">{l.title}</td>\r\n                  <td className=\"px-4 py-3\">{m ? `M${m.moduleNo} — ${m.title}` : \"-\"}</td>\r\n                  <td className=\"px-4 py-3\">\r\n                    <a href={l.videoUrl} target=\"_blank\" className=\"underline break-words\" rel=\"noreferrer\">\r\n                      {l.videoUrl}\r\n                    </a>\r\n                  </td>\r\n                  <td className=\"px-4 py-3\">\r\n                    {l.pdfs?.length ? (\r\n                      <ul className=\"list-disc ml-5\">\r\n                        {l.pdfs.map(p => (\r\n                          <li key={p.url}>\r\n                            <a href={p.url} target=\"_blank\" rel=\"noreferrer\" className=\"underline\">{p.name}</a>\r\n                          </li>\r\n                        ))}\r\n                      </ul>\r\n                    ) : <span className=\"text-gray-500\">—</span>}\r\n                  </td>\r\n                </tr>\r\n              );\r\n            })}\r\n            {!filtered.length && (\r\n              <tr>\r\n                <td className=\"px-4 py-6 text-gray-500\" colSpan={5}>No lectures found.</td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":"4EAAA,IAAM,EAAA,wBAGC,eAAe,EAAiB,CAAY,CAAE,EAAoB,CAAC,CAAC,EAEzE,IAAM,EAAU,IAAI,QAAQ,EAAK,OAAO,CACpC,CAAC,EAAQ,GAAG,CAAC,iBAAiB,EAAQ,GAAG,CAAC,eAAgB,oBAE9D,IAAM,EAAM,MAAM,MAAM,CAAA,EAAG,EAAA,EAAO,EAAA,CAAM,CAAE,CAAE,GAAG,CAAI,SAAE,EAAS,MAAO,UAAW,GAChF,GAAI,CAAC,EAAI,EAAE,CAAE,MAAM,MAAM,EAAI,IAAI,GAAG,KAAK,CAAC,IAAM,AAAC,EAAE,QAAS,EAAI,UAAU,CAAC,CAAC,EAC5E,OAAQ,MAAM,EAAI,IAAI,EACxB,CAGO,eAAe,EAAuB,CAAY,CAAE,EAAoB,CAAC,CAAC,EAC/E,IAAM,EAAM,MAAM,MAAM,CAAA,EAAG,EAAA,EAAO,EAAA,CAAM,CAAE,CAAE,GAAG,CAAI,CAAE,MAAO,UAAW,GACvE,GAAI,CAAC,EAAI,EAAE,CAAE,MAAM,MAAM,EAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAE,QAAS,EAAI,UAAU,CAAC,CAAC,EAC5E,OAAQ,MAAM,EAAI,IAAI,EACxB,kEChBA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAGe,SAAS,IACtB,GAAM,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAW,EAAE,EAC7C,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAW,EAAE,EAC7C,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAY,EAAE,EAChD,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,IAC3C,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,IAC3C,CAAC,EAAG,EAAK,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAE3B,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,CAAC,UAEC,EADW,MAAM,CAAA,EAAA,AACN,EADM,GAAA,AAAG,EAAW,aAEjC,CAAC,EACH,EAAG,EAAE,EAEL,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,CAAC,UAGC,EADW,MAAM,CAAA,EAAA,AACN,EADM,GAAA,AAAG,EAAW,CAAC,QAAQ,EAAE,EAAW,CAAC,QAAQ,EAAE,EAAA,CAAU,CAAG,GAAA,CAAI,GAGjF,EAAY,GACd,CAAC,GACH,EAAG,CAAC,EAAS,EAEb,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,CAAC,UACC,IAAM,EAAe,EAAE,CACnB,GAAU,EAAG,IAAI,CAAC,CAAC,OAAO,EAAE,EAAA,CAAU,EACtC,GAAU,EAAG,IAAI,CAAC,CAAC,OAAO,EAAE,EAAA,CAAU,EAC1C,IAAM,EAAM,CAAC,SAAS,EAAE,EAAG,MAAM,CAAG,CAAC,CAAC,EAAE,EAAG,IAAI,CAAC,KAAA,CAAM,CAAG,GAAA,CAAI,CAE7D,EADW,MAAM,CAAA,EAAA,CACL,CADK,GAAA,AAAG,EAAY,IAElC,CAAC,EACH,EAAG,CAAC,EAAU,EAAS,EAEvB,IAAM,EAAW,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KACvB,IAAM,EAAO,EAAE,IAAI,GAAG,WAAW,GACjC,OAAO,EAAO,EAAS,MAAM,CAAC,GAAK,EAAE,KAAK,CAAC,WAAW,GAAG,QAAQ,CAAC,IAAS,CAC7E,EAAG,CAAC,EAAU,EAAE,EAEhB,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,kEACd,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,0CAAiC,iBAC/C,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yBAAgB,oDAI/B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,MAAO,EACP,SAAU,AAAC,GAAM,EAAY,EAAE,MAAM,CAAC,KAAK,EAC3C,UAAU,wCAEV,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,YAAG,gBAChB,EAAQ,GAAG,CAAC,GAAK,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAmB,MAAO,EAAE,GAAG,UAAG,EAAE,KAAK,EAA7B,EAAE,GAAG,MAGtC,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,MAAO,EACP,SAAU,AAAC,GAAM,EAAY,EAAE,MAAM,CAAC,KAAK,EAC3C,UAAU,wCAEV,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,YAAG,gBAChB,EAAQ,GAAG,CAAC,GACX,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAmB,MAAO,EAAE,GAAG,UAC7B,CAAC,OAAO,EAAE,EAAE,QAAQ,CAAC,EAAE,EAAE,EAAE,KAAK,CAAA,CAAE,EADxB,EAAE,GAAG,MAMtB,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,MAAO,EACP,SAAU,AAAC,GAAM,EAAK,EAAE,MAAM,CAAC,KAAK,EACpC,YAAY,2BACZ,UAAU,mCAKd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,4CACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,+BACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,gCACf,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,qBAAY,UAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,qBAAY,kBAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,qBAAY,WAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,qBAAY,cAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,qBAAY,cAG9B,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,WACE,EAAS,GAAG,CAAC,IACZ,IAAM,EAAI,EAAQ,IAAI,CAAC,GAAK,EAAE,GAAG,GAAK,EAAE,QAAQ,EAChD,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAe,UAAU,qBACxB,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAU,kCAAwB,IAAE,EAAE,KAAK,IAC/C,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,qBAAa,EAAE,KAAK,GAClC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,qBAAa,EAAI,CAAC,CAAC,EAAE,EAAE,QAAQ,CAAC,GAAG,EAAE,EAAE,KAAK,CAAA,CAAE,CAAG,MAC/D,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,qBACZ,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,KAAM,EAAE,QAAQ,CAAE,OAAO,SAAS,UAAU,wBAAwB,IAAI,sBACxE,EAAE,QAAQ,KAGf,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,qBACX,EAAE,IAAI,EAAE,OACP,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,0BACX,EAAE,IAAI,CAAC,GAAG,CAAC,GACV,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,KAAM,EAAE,GAAG,CAAE,OAAO,SAAS,IAAI,aAAa,UAAU,qBAAa,EAAE,IAAI,IADvE,EAAE,GAAG,KAKhB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yBAAgB,UAlB/B,EAAE,GAAG,CAsBlB,GACC,CAAC,EAAS,MAAM,EACf,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,0BAA0B,QAAS,WAAG,mCAQpE"}