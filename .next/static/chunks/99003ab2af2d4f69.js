(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,16698,e=>{"use strict";e.s(["api",()=>t,"serverApi",()=>l]);let s="http://localhost:4000";async function t(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=localStorage.getItem("token"),a=new Headers(t.headers);a.has("Content-Type")||a.set("Content-Type","application/json"),l&&a.set("Authorization","Bearer ".concat(l));let r=await fetch("".concat(s).concat(e),{...t,headers:a,cache:"no-store"});if(!r.ok)throw await r.json().catch(()=>({message:r.statusText}));return await r.json()}async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=await fetch("".concat(s).concat(e),{...t,cache:"no-store"});if(!l.ok)throw await l.json().catch(()=>({message:l.statusText}));return await l.json()}},87916,e=>{"use strict";e.s(["default",()=>r]);var s=e.i(22834),t=e.i(74340),l=e.i(94449),a=e.i(16698);function r(){var e;let r,{courseId:c}=(0,l.useParams)(),[n,i]=(0,t.useState)([]),[d,o]=(0,t.useState)([]),[u,h]=(0,t.useState)([]),[m,x]=(0,t.useState)(null),[p,f]=(0,t.useState)(!0),[g,v]=(0,t.useState)("");(0,t.useEffect)(()=>{(async()=>{var e,s;f(!0);let[t,l]=await Promise.all([(0,a.serverApi)("/modules?course=".concat(c)),(0,a.serverApi)("/lectures?course=".concat(c))]);l.sort((e,s)=>e.order-s.order),i(t),o(l);try{let s=await (0,a.serverApi)("/progress?course=".concat(c));h(null!=(e=s.completedLectureIds)?e:[])}catch(e){h([])}x(null!=(s=l[0])?s:null),f(!1)})()},[c]);let j=d.length,N=u.length,y=j?Math.round(N/j*100):0,b=(0,t.useMemo)(()=>{let e=new Map;for(let[s,t]of(n.forEach(s=>e.set(s._id,[])),d.forEach(s=>{var t;return null==(t=e.get(s.moduleId))?void 0:t.push(s)}),e.entries()))t.sort((e,s)=>e.order-s.order);return e},[n,d]);async function w(){if(!m)return;try{var e;let s=await (0,a.api)("/progress/complete",{method:"POST",body:JSON.stringify({courseId:c,lectureId:m._id})});h(null!=(e=s.completedLectureIds)?e:[])}catch(e){h(e=>e.includes(m._id)?e:[...e,m._id])}let s=d.findIndex(e=>e._id===m._id),t=d[s+1];t&&x(t)}return p?(0,s.jsx)("div",{className:"p-6",children:"Loadingâ€¦"}):m?(0,s.jsxs)("div",{className:"max-w-7xl mx-auto p-4 md:p-6 grid gap-4 md:gap-6 md:grid-cols-[320px_1fr]",children:[(0,s.jsxs)("aside",{className:"rounded-2xl border h-[82vh] overflow-auto p-3 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Progress"}),(0,s.jsxs)("span",{className:"font-medium",children:[N,"/",j," â€¢ ",y,"%"]})]}),(0,s.jsx)("div",{className:"mt-2 h-2 w-full rounded bg-gray-200",children:(0,s.jsx)("div",{className:"h-2 rounded bg-black transition-all",style:{width:"".concat(y,"%")}})})]}),(0,s.jsx)("input",{className:"w-full rounded-xl border px-3 py-2 outline-none focus:ring-2 focus:ring-black/70",placeholder:"Search lessonâ€¦",value:g,onChange:e=>v(e.target.value)}),(0,s.jsx)("div",{className:"space-y-3",children:n.map(e=>{var t;let l=(null!=(t=b.get(e._id))?t:[]).filter(e=>e.title.toLowerCase().includes(g.toLowerCase()))||[];return(0,s.jsxs)("div",{className:"rounded-xl border",children:[(0,s.jsxs)("div",{className:"px-3 py-2 font-semibold bg-gray-50 rounded-t-xl",children:["Module ",e.moduleNo,": ",e.title]}),(0,s.jsxs)("ul",{className:"p-2 space-y-1",children:[l.map(e=>{let t=m._id===e._id,l=!(e=>{if(1===e.order)return!0;let s=d.find(s=>s.order===e.order-1);return!s||u.includes(s._id)})(e),a=u.includes(e._id);return(0,s.jsx)("li",{children:(0,s.jsxs)("button",{onClick:()=>!l&&x(e),className:"w-full text-left px-2 py-1.5 rounded flex items-center gap-2 ".concat(t?"bg-black text-white":l?"text-gray-400 cursor-not-allowed":"hover:bg-gray-100"),children:[(0,s.jsx)("span",{className:"text-lg leading-none",children:a?"âœ…":l?"ðŸ”’":"â­•"}),(0,s.jsx)("span",{className:"flex-1 truncate",children:e.title}),(0,s.jsxs)("span",{className:"text-xs opacity-70",children:["#",e.order]})]})},e._id)}),!l.length&&(0,s.jsx)("li",{className:"px-2 py-1 text-sm text-gray-500",children:"No matching lessons"})]})]},e._id)})})]}),(0,s.jsxs)("section",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"rounded-2xl overflow-hidden bg-black aspect-video",children:(0,s.jsx)("iframe",{className:"w-full h-full",src:(null==(r=m.videoUrl)?void 0:r.includes("watch?v="))?r.replace("watch?v=","embed/"):r,title:m.title,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0})}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"font-semibold",children:m.title}),(0,s.jsxs)("div",{className:"space-x-2",children:[(0,s.jsx)("button",{onClick:function(){if(!m)return;let e=d.findIndex(e=>e._id===m._id),s=d[e-1];s&&x(s)},className:"px-3 py-2 rounded border",children:"Previous"}),(0,s.jsx)("button",{onClick:w,className:"px-3 py-2 rounded bg-black text-white",children:"Next"})]})]}),(0,s.jsxs)("div",{className:"rounded-2xl border p-4",children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Notes (PDF)"}),(null==(e=m.pdfs)?void 0:e.length)?(0,s.jsx)("ul",{className:"list-disc ml-5 space-y-1",children:m.pdfs.map(e=>(0,s.jsx)("li",{children:(0,s.jsx)("a",{className:"underline",href:e.url,target:"_blank",rel:"noreferrer",children:e.name})},e.url))}):(0,s.jsx)("div",{className:"text-gray-500",children:"No notes for this lecture."})]})]})]}):(0,s.jsx)("div",{className:"p-6",children:"No lectures available yet."})}}]);