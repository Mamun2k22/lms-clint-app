(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[668],{63:(e,s,t)=>{"use strict";var a=t(7260);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}})},104:(e,s,t)=>{Promise.resolve().then(t.bind(t,3379))},3379:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>c});var a=t(5155),l=t(2115),r=t(63),n=t(6890);function c(){var e;let s,{courseId:t}=(0,r.useParams)(),[c,i]=(0,l.useState)([]),[d,o]=(0,l.useState)([]),[u,h]=(0,l.useState)([]),[m,x]=(0,l.useState)(null),[p,f]=(0,l.useState)(!0),[g,j]=(0,l.useState)("");(0,l.useEffect)(()=>{(async()=>{var e,s;f(!0);let[a,l]=await Promise.all([(0,n.Q)("/modules?course=".concat(t)),(0,n.Q)("/lectures?course=".concat(t))]);l.sort((e,s)=>e.order-s.order),i(a),o(l);try{let s=await (0,n.Q)("/progress?course=".concat(t));h(null!=(e=s.completedLectureIds)?e:[])}catch(e){h([])}x(null!=(s=l[0])?s:null),f(!1)})()},[t]);let v=d.length,N=u.length,y=v?Math.round(N/v*100):0,b=(0,l.useMemo)(()=>{let e=new Map;for(let[s,t]of(c.forEach(s=>e.set(s._id,[])),d.forEach(s=>{var t;return null==(t=e.get(s.moduleId))?void 0:t.push(s)}),e.entries()))t.sort((e,s)=>e.order-s.order);return e},[c,d]);async function w(){if(!m)return;try{var e;let s=await (0,n.F)("/progress/complete",{method:"POST",body:JSON.stringify({courseId:t,lectureId:m._id})});h(null!=(e=s.completedLectureIds)?e:[])}catch(e){h(e=>e.includes(m._id)?e:[...e,m._id])}let s=d.findIndex(e=>e._id===m._id),a=d[s+1];a&&x(a)}return p?(0,a.jsx)("div",{className:"p-6",children:"Loading…"}):m?(0,a.jsxs)("div",{className:"max-w-7xl mx-auto p-4 md:p-6 grid gap-4 md:gap-6 md:grid-cols-[320px_1fr]",children:[(0,a.jsxs)("aside",{className:"rounded-2xl border h-[82vh] overflow-auto p-3 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Progress"}),(0,a.jsxs)("span",{className:"font-medium",children:[N,"/",v," • ",y,"%"]})]}),(0,a.jsx)("div",{className:"mt-2 h-2 w-full rounded bg-gray-200",children:(0,a.jsx)("div",{className:"h-2 rounded bg-black transition-all",style:{width:"".concat(y,"%")}})})]}),(0,a.jsx)("input",{className:"w-full rounded-xl border px-3 py-2 outline-none focus:ring-2 focus:ring-black/70",placeholder:"Search lesson…",value:g,onChange:e=>j(e.target.value)}),(0,a.jsx)("div",{className:"space-y-3",children:c.map(e=>{var s;let t=(null!=(s=b.get(e._id))?s:[]).filter(e=>e.title.toLowerCase().includes(g.toLowerCase()))||[];return(0,a.jsxs)("div",{className:"rounded-xl border",children:[(0,a.jsxs)("div",{className:"px-3 py-2 font-semibold bg-gray-50 rounded-t-xl",children:["Module ",e.moduleNo,": ",e.title]}),(0,a.jsxs)("ul",{className:"p-2 space-y-1",children:[t.map(e=>{let s=m._id===e._id,t=!(e=>{if(1===e.order)return!0;let s=d.find(s=>s.order===e.order-1);return!s||u.includes(s._id)})(e),l=u.includes(e._id);return(0,a.jsx)("li",{children:(0,a.jsxs)("button",{onClick:()=>!t&&x(e),className:"w-full text-left px-2 py-1.5 rounded flex items-center gap-2 ".concat(s?"bg-black text-white":t?"text-gray-400 cursor-not-allowed":"hover:bg-gray-100"),children:[(0,a.jsx)("span",{className:"text-lg leading-none",children:l?"✅":t?"\uD83D\uDD12":"⭕"}),(0,a.jsx)("span",{className:"flex-1 truncate",children:e.title}),(0,a.jsxs)("span",{className:"text-xs opacity-70",children:["#",e.order]})]})},e._id)}),!t.length&&(0,a.jsx)("li",{className:"px-2 py-1 text-sm text-gray-500",children:"No matching lessons"})]})]},e._id)})})]}),(0,a.jsxs)("section",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"rounded-2xl overflow-hidden bg-black aspect-video",children:(0,a.jsx)("iframe",{className:"w-full h-full",src:(null==(s=m.videoUrl)?void 0:s.includes("watch?v="))?s.replace("watch?v=","embed/"):s,title:m.title,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0})}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"font-semibold",children:m.title}),(0,a.jsxs)("div",{className:"space-x-2",children:[(0,a.jsx)("button",{onClick:function(){if(!m)return;let e=d.findIndex(e=>e._id===m._id),s=d[e-1];s&&x(s)},className:"px-3 py-2 rounded border",children:"Previous"}),(0,a.jsx)("button",{onClick:w,className:"px-3 py-2 rounded bg-black text-white",children:"Next"})]})]}),(0,a.jsxs)("div",{className:"rounded-2xl border p-4",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Notes (PDF)"}),(null==(e=m.pdfs)?void 0:e.length)?(0,a.jsx)("ul",{className:"list-disc ml-5 space-y-1",children:m.pdfs.map(e=>(0,a.jsx)("li",{children:(0,a.jsx)("a",{className:"underline",href:e.url,target:"_blank",rel:"noreferrer",children:e.name})},e.url))}):(0,a.jsx)("div",{className:"text-gray-500",children:"No notes for this lecture."})]})]})]}):(0,a.jsx)("div",{className:"p-6",children:"No lectures available yet."})}},6890:(e,s,t)=>{"use strict";t.d(s,{F:()=>l,Q:()=>r});let a="https://lms-system-backend-dusky.vercel.app";async function l(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=localStorage.getItem("token"),l=new Headers(s.headers);l.has("Content-Type")||l.set("Content-Type","application/json"),t&&l.set("Authorization","Bearer ".concat(t));let r=await fetch("".concat(a).concat(e),{...s,headers:l,cache:"no-store"});if(!r.ok)throw await r.json().catch(()=>({message:r.statusText}));return await r.json()}async function r(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=await fetch("".concat(a).concat(e),{...s,cache:"no-store"});if(!t.ok)throw await t.json().catch(()=>({message:t.statusText}));return await t.json()}}},e=>{e.O(0,[441,255,358],()=>e(e.s=104)),_N_E=e.O()}]);